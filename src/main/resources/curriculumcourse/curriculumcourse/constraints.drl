package curriculumcourse.curriculumcourse
dialect "java"
import java.util.Set
import java.util.HashSet
function int countInt(Set s) { return s.size(); }

rule "Minimum working days"
when
  $course : Course( $min : minimumWorkingDays )
  Number( $distinct : intValue ) from accumulate(
     // 綁定 day；action/result 不做點號呼叫
     Lecture( course == $course, $day : period.day ),
     init( Set days = new HashSet(); ),
     action( days.add( $day ); ),
     reverse( ),
     result( countInt(days) )
  )
  eval( $distinct < $min )
then
  scoreHolder.addSoftPenalty(kcontext, $min - $distinct);
end
